\chapter{Shape Sensitivity Analysis for Coupled Fluid-Structure Interaction Problems}\label{ch:FSIsen}
Fluid-Structure interaction (FSI) is a multiphysics coupling of the physical laws that govern fluid mechanics and structural dynamics. When the fluid flows over or inside a structure, it causes stresses on the solid object. These stresses can cause large or small deformations in the structure with leads to change in its shape. Depending on the magnitude of the stress, these deformations can be small or large. The effect of small deformations of the solid can be neglected since they do not affect the fluid flow. However, if the deformations are large, the pressure and velocity field of the fluid will change as a result.

In this chapter, we start with a survey of different coupling and solution methods available for solving a coupled FSI problem. To handle the mesh deformation shortcoming of large structural deformations, we will propose the IB method for managing these multiphysics simulations. We will build on the work of Chapter \ref{ch:shapeSenwithIB} to develop shape sensitivity analysis for a coupled FSI system. The shape sensitivity analysis developed here is demonstrated on various coupled systems. Throughout this chapter we consider the flow of \emph{incompressible laminar Newtonian fluid} governed by Navier-Stokes (NS) equations interacting with an \emph{elastic structure}. 

% ======================================================================================
\input{Chapter_5/Chapter_5_Fluid_Structure_Interaction.tex}
\input{Chapter_5/Chapter_5_Shape_Sensitivity_Analysis.tex}
\section{Demonstration Problems}
\input{Chapter_5/Chapter_5_Vortex_induced_vibration.tex}
\input{Chapter_5/Chapter_5_Pitch_and_plunge_airfoil_motion.tex}
\input{Chapter_5/Chapter_5_Flapping_and_bending_monofin.tex}
% ======================================================================================
\section{Summary}
In this chapter we formulated the sensitivity analysis for coupled fluid-structure interaction problems. Fluid-structure coupling is achieved by transferring the loads from the Eulerian nodes of the fluid domain to the structure Lagrangian nodes by the regularized delta function of Equation \eqref{eq:C4_heavisideFunction}. The effect of solid deformation and velocity is transferred to the fluid domain by the force term in the Navier-Stokes equations as described in Chapter \ref{ch:immersedBoundary}. In this chapter, we verified our fluid-structure coupling by looking at the vortex shedding frequency of flow around circular cylinder at two different Reynolds number. We derived the governing sensitivity equation for the coupled problem by differentiating the governing equation for each discipline and also the interface dynamic and kinematic constraints. To solve the sensitivity equations for the structure domain, the load sensitivity are required which are calculated by solving the differentiated Navier-Stokes equations. We applied this methodology to  various demonstration problems as shown in this chapter. Due to the unsteadiness of these coupled problems, the unsteady sensitivity analysis is conducted and the results are verified using complex step method. As shown in the results section, the solution of analytical sensitivity analysis agrees well with the complex step results.